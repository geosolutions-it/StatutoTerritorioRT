<!--

Copyright 2018, GeoSolutions Sas.
All rights reserved.

This source code is licensed under the BSD-style license found in the
LICENSE file in the root directory of this source tree.

-->


<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">

    {% load static %}
    {% load i18n %}
    {% load rules %}

    <head>

        <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block head_title %}Statuto Territorio RT{% endblock head_title %}</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!-- CSS -->
        <link rel="stylesheet" href="{% static 'css/serapide.css' %}"/>
        <link rel="stylesheet" href="{% static 'base/css/base.css' %}"/>
        {% block styles %}
        {% endblock styles %}

    </head>

    <body>

        <!-- CONTAINER-FLUID -->
        <div class="container-fluid p-0">

            <!-- TOP-NAVBAR -->
<<<<<<< HEAD
            <nav class="navbar navbar-expand-sm navbar-dark bg-dark sticky-top pl-0 py-0">
=======
            <nav class="navbar navbar-expand-sm navbar-dark bg-dark sticky-top pl-0 py-0 pr-1">
>>>>>>> Added Apollo, react-router, recompose, Serapide navbar, home page

                <!-- BRAND -->
                <a class="navbar-brand p-0" href="/">
                    <img src="{% static 'img/RT_logo.png' %}" alt="RT Logo"
                        class="d-inline-block img-fluid rt-logo p-0">
                    <span class="d-none d-lg-inline-block pl-2">
                        {% trans 'Portale del Territorio' %}
                    </span>
                </a><!-- end BRAND -->

                <!-- TOGGLER BUTTON -->
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button><!-- end TOGGLER BUTTON -->

                <!-- NAVBAR COLLPSABLE CONTENT -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto pl-2">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{% url 'serapide' %}"
                               {% if not request.user.is_authenticated %}
                                    data-toggle="modal" data-target="#exampleModal"
                               {% endif %}>
                                <span>{% trans 'area riservata'|capfirst %}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{% url 'geoportal' %}">
                                <span>{% trans 'geoportale'|upper %}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{% url 'opendata' %}">
                                <span>{% trans 'open data'|upper %}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white pr-0" href="{% url 'glossary' %}">
                                <span>{% trans 'glossario'|upper %}</span>
                            </a>
                        </li>
                    </ul>
                </div><!-- end NAVBAR COLLPSABLE CONTENT -->

            </nav><!-- end TOP-NAVBAR -->

            {% has_perm 'strt_users.can_manage_users' request.user as can_manage_users %}
            {% if can_manage_users %}

                <!-- USER-NAVBAR -->
                <div class="serapide" id="user-navbar">

                    <nav class="serapide-top-offset pr-1 navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-end">

                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                                data-target="#userNavbarSupportedContent" aria-controls="userNavbarSupportedContent"
                                aria-expanded="true" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>

                        <div class="collapse navbar-collapse" id="userNavbarSupportedContent">
                            <ul class="ml-auto text-center navbar-nav" id="user-navbar-list">

                                <div class="usermenu text-white dropdown order-last">
                                    <a aria-haspopup="true" href="" class=" p-0 dropdown-toggle nav-link"
                                       aria-expanded="false" data-toggle="dropdown">
                                        <span class="link-icon d-inline-flex flex-row">
                                            <i class="material-icons text-warning m-1 rounded-circle bg-white">group</i>
                                            <div class="flex-column align-self-center">
                                                <div class="link-icon-label ">
                                                    {% trans 'gestione utenti'|capfirst %}
                                                </div>
                                            </div>
                                        </span>
                                    </a>
                                    <div role="menu" aria-hidden="true"
                                         class="dropdown-menu dropdown-menu-right dropdown-menu-portal">
                                        <a class="dropdown-item" href="{% url 'users_list' %}">
                                            {% trans 'lista utenti'|capfirst %}
                                        </a>
                                        <a class="dropdown-item" href="{% url 'users_membership_list' %}">
                                            {% trans 'lista ruoli'|capfirst %}
                                        </a>
                                        <a class="dropdown-item" href="{% url 'user_registration' %}">
                                            {% trans 'registra utente'|capfirst %}
                                        </a>
                                        <a class="dropdown-item" href="{% url 'user_membership_registration' %}">
                                            {% trans 'registra ruolo'|capfirst %}
                                        </a>
                                    </div>
                                </div>
                                <div class="usermenu text-white dropdown order-last">
                                    <a aria-haspopup="true" href="" class=" p-0 dropdown-toggle nav-link"
                                       data-toggle="dropdown" aria-expanded="false">
                                        <span class="link-icon d-inline-flex flex-row">
                                            <i class="material-icons text-warning m-1 rounded-circle bg-white">person</i>
                                            <div class="flex-column align-self-center">
                                                <div class="link-icon-label ">
                                                    {{ request.user.get_full_name }}
                                                </div>
                                            </div>
                                        </span>
                                    </a>
                                    <div role="menu" aria-hidden="true"
                                         class="dropdown-menu dropdown-menu-right dropdown-menu-portal">
                                        <span class="role text-warning">{% trans 'ruolo'|upper %}:</span>
                                        {% for m in request.user.memberships %}
                                            <span class="d-block role role-item text-warning">{{ m.name }}</span>
                                        {% endfor %}
                                        <a class="dropdown-item" href="{% url 'users_profile_detail' %}">
                                            {% trans 'profilo'|capfirst %}
                                        </a>
                                        <a class="dropdown-item" href="">
                                            {% trans 'impostazioni'|capfirst %}
                                        </a>
                                        <a class="dropdown-item" href="{% url 'logout' %}">
                                            {% trans 'logout'|capfirst %}
                                        </a>
                                    </div>
                                </div>
                            </ul>
                        </div>

                    </nav>

                </div>
                <!-- USER-NAVBAR -->

            {% endif %}

            <!-- MODAL FORM TODO: remove in produciton -->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                 aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Autenticazione</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label for="recipient-name" class="col-form-label">Nome:</label>
                                    <input type="text" class="form-control" id="user-first-name">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Cognome:</label>
                                    <input type="text" class="form-control" id="user-last-name">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Codice fiscale:</label>
                                    <input type="text" class="form-control" id="user-fiscal-code">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Ruolo:</label>
                                    <input type="text" class="form-control" id="user-role">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label d-block">Enti:</label>
                                    <input type="text" class="form-control d-inline w-75" id="add">
                                    <input type="button" id="btnAdd" value="+" onclick="addItem()">
                                    <ul id="organizations" class="pl-0 pt-2">
                                    </ul>
                                </div>
                            </form>
                            <span class="text-danger" id="errors"><br></span>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary close-btn" data-dismiss="modal">Chiudi</button>
                            <button type="sbmit" class="btn btn-primary submit-btn">Avvia</button>
                        </div>
                    </div>
                </div>
            </div><!-- end MODAL FORM TODO: remove in produciton -->

            <!-- CONTENT -->
            <div class="content bg-light">

                <!-- start content block -->
                {% block content %}

                    <!-- put the content here -->

                {% endblock content %}
                <!-- end content block -->

            </div> <!-- end CONTENT -->

            <!-- FOOTER -->
            <div class="footer footer-padding-trans bg-light w-100">
                <div class="row p-2 m-0 text-secondary">
                    <div class="col-12 col-lg-1 m-0 p-0 text-uppercase">{% trans 'contatti' %}</div>
                    <div class="col-12 col-lg-2 p-lg-0 m-lg-0">
                        <br class="d-none d-lg-inline">
                        <div class="row">
                            <div class="col-12 p-0 m-0">
                                <small>+345 678 903</small>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>email@pianificazioneterritoriale.it</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>...</small>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-1 p-0 m-0 text-uppercase">{% trans 'supporto' %}</div>
                    <div class="col-12 col-lg-2 p-lg-0 m-lg-0">
                        <br class="d-none d-lg-inline">
                        <div class="row">
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'documentazione'|capfirst %}</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'WIKI' %}</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'FAQ' %}</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'tutorial'|capfirst %}</small>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-1 p-0 m-0 text-uppercase">{% trans 'informazioni' %}</div>
                    <div class="col-12 col-lg-2 p-lg-0 m-lg-0">
                        <br class="d-none d-lg-inline">
                        <div class="row">
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'Privacy Policy'|capfirst %}</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'Termini & condizioni'|capfirst %}</small>
                                </a>
                            </div>
                            <div class="col-12 p-0 m-0">
                                <a href="/">
                                    <small>{% trans 'Ufficio Stampa'|capfirst %}</small>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-3 text-right align-self-end">
                        <small>{% trans '@ Regione Toscana'|capfirst %}</small>
                    </div>
                </div>
            </div> <!-- end FOOTER -->

        </div> <!-- end CONTAINER-FLUID -->

        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
        <script src="{% static 'js/popper.min.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'strt_users/js/auth.js' %}"></script>

        <script>

            // If user-nav is visible (user logged in)
            if ($('.serapide').length > 0) {
                $('.content').css('padding-top', '60px');
                /*$('.content').css('padding-left', '250px');
                $('.footer').css('padding-left', '250px');
                let ww = $(window).width();
                if (ww < 1199.98) {
                    $('.sidebar').hide();
                    $('.content').css('padding-left', '0px');
                    $('.footer').css('padding-left', '0px');
                }
                $('#sidebar-toggler').click(function() {
                    if ($('.sidebar').is(':visible')) {
                        $('.sidebar').fadeOut(500);
                        $('.content').css('padding-left', '0px');
                        $('.footer').css('padding-left', '0px');
                    } else {
                        $('.sidebar').fadeIn(500);
                        let sw = $('.sidebar').width();
                        let spl = $('.sidebar').css('padding-left');
                        let tot = sw + parseFloat(spl.replace('px',''));
                        $('.content').css('padding-left', tot + 'px');
                        $('.footer').css('padding-left', tot + 'px');
                    }
                });*/
            }

            if ($('#serapide').length > 0) {
                $('.content').css('padding-left', '0px');
                $('.content').css('padding-right', '0px');
            }

        </script>

        {% block add_script %}
        {% endblock add_script %}

    </body>

</html>
